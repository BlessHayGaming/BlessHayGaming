{"hash":"d78917af8e10e3607f1017899608e144fac9a825","data":{"learnPost":{"id":"00e5f28e3186450d22c308f2834194b2","title":"Timers and Countdowns in GMS2","content":"<h2 id=\"introduction\"><a href=\"#introduction\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Introduction</h2>\n<p>Something I use often when making games are timers and countdowns. Sometimes it is enough to do a simple <code>my_timer++;</code> in the <em>Step</em> event, but sometimes I need more precision. It is for those times I have made the following scripts for easily making timers and countdowns!</p>\n<p>The timers and countdowns are initiated like so;</p>\n<pre><code class=\"language-gml\">my_timer = timer_create();\nmy_countdown = countdown_create(10000);\n</code></pre>\n<p>They both function similarly, and are based around milliseconds. Only difference: Timers count up and countdowns count... down.</p>\n<p>To update a timer or coundown, which you normally would do once every step, you simply use <code>timer_update(my_timer);</code> or <code>countdown_update(my_countdown);</code>, and to get the current time of the timer or countdown you use <code>timer_get(my_timer);</code> or <code>countdown_get(my_countdown);</code>. This will return how much time has passed for the timers, or how much time is left for the countdowns, both in milliseconds. Divide this with 1000 to get the value in seconds.</p>\n<p>Towards the end of this post I will examplify a use and explain the choices behind the scripts, but first I will simply lay out all the scripts:</p>\n<h2 id=\"timer-scripts\"><a href=\"#timer-scripts\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Timer Scripts</h2>\n<pre><code class=\"language-gml\">///timer_create();\n//Usage: my_timer = timer_create();\nvar _a;\n_a[0] = 0;\nreturn _a;\n</code></pre>\n<pre><code class=\"language-gml\">///timer_update(timer);\n//Usage: timer_update(my_timer);\nvar _a = argument0;\n_a[@ 0] += delta_time/1000;\nreturn _a;\n</code></pre>\n<pre><code class=\"language-gml\">///timer_get(timer);\n//Usage: time_passed = timer_get(my_timer);\nvar _a = argument0;\nreturn _a[0];\n</code></pre>\n<pre><code class=\"language-gml\">///timer_set(timer,time);\n//Usage: timer_set(my_timer,0);\nvar _a = argument0;\n_a[@ 0] = argument1;\nreturn _a;\n</code></pre>\n<pre><code class=\"language-gml\">///timer_add(timer,amt);\n//Usage: timer_add(my_timer,1000);\nvar _a = argument0;\n_a[@ 0] += argument1;\nreturn _a;\n</code></pre>\n<pre><code class=\"language-gml\">///timer_subtract(timer,amt);\n//Usage: timer_subtract(my_timer,1000);\nvar _a = argument0;\n_a[@ 0] -= argument1;\nreturn _a;\n</code></pre>\n<pre><code class=\"language-gml\">///timer_multiply(timer,scalar);\n//Usage: timer_multiply(my_timer,2);\nvar _a = argument0;\n_a[@ 0] *= argument1;\nreturn _a;\n</code></pre>\n<pre><code class=\"language-gml\">///timer_divide(timer,val);\n//Usage: timer_divide(my_timer,2);\nvar _a = argument0;\n_a[@ 0] /= argument1;\nreturn _a;\n</code></pre>\n<h2 id=\"countdown-scripts\"><a href=\"#countdown-scripts\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Countdown Scripts</h2>\n<pre><code class=\"language-gml\">///countdown_create(ms);\n//Usage: my_countdown = countdown_create();\nvar _a;\n_a[0] = argument0;\nreturn _a;\n</code></pre>\n<pre><code class=\"language-gml\">///countdown_update(countdown);\n//Usage: countdown_update(my_countdown);\nvar _a = argument0;\n_a[@ 0] -= delta_time/1000;\nreturn _a;\n</code></pre>\n<pre><code class=\"language-gml\">///countdown_get(countdown);\n//Usage: time_left = countdown_get(my_countdown);\nvar _a = argument0;\nreturn _a[0];\n</code></pre>\n<pre><code class=\"language-gml\">///countdown_set(countdown,time);\n//Usage: countdown_set(my_countdown,10000);\nvar _a = argument0;\n_a[@ 0] = argument1;\nreturn _a;\n</code></pre>\n<pre><code class=\"language-gml\">///countdown_add(countdown,amt);\n//Usage: countdown_add(my_countdown,1000);\nvar _a = argument0;\n_a[@ 0] += argument1;\nreturn _a;\n</code></pre>\n<pre><code class=\"language-gml\">///countdown_subtract(countdown,amt);\n//Usage: countdown_subtract(my_countdown,1000);\nvar _a = argument0;\n_a[@ 0] -= argument1;\nreturn _a;\n</code></pre>\n<pre><code class=\"language-gml\">///countdown_multiply(countdown,scalar);\n//Usage: countdown_multiply(my_countdown,2);\nvar _a = argument0;\n_a[@ 0] *= argument1;\nreturn _a;\n</code></pre>\n<pre><code class=\"language-gml\">///countdown_divide(countdown,val);\n//Usage: countdown_divide(my_countdown,2);\nvar _a = argument0;\n_a[@ 0] /= argument1;\nreturn _a;\n</code></pre>\n<h2 id=\"example-of-use\"><a href=\"#example-of-use\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Example of use</h2>\n<p>Say we have a game where the room restarts every 60 seconds. A controller object could keep track of this, and be set up like this:</p>\n<h3 id=\"create-event\"><a href=\"#create-event\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Create event</h3>\n<pre><code class=\"language-gml\">restart_cd = countdown_create(60000);\n</code></pre>\n<h3 id=\"step-event\"><a href=\"#step-event\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Step event</h3>\n<pre><code class=\"language-gml\">if !global.pause {\n countdown_update(restart_cd);\n if countdown_get(restart_cd) &#x26;lt;= 0 {\n  room_restart();\n }\n}\n</code></pre>\n<h3 id=\"draw-gui-event\"><a href=\"#draw-gui-event\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Draw gui event</h3>\n<pre><code class=\"language-gml\">draw_text(10,10,string(ceil(countdown_get(restart_cd)/1000)));\n</code></pre>\n<p>The countdown will then keep counting down unless paused by the <strong>global.pause</strong> variable. The countdown will be drawn to the screen in seconds, and when the countdown reaches 0 the room will restart.</p>\n<h2 id=\"behind-the-scripts\"><a href=\"#behind-the-scripts\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Behind the Scripts</h2>\n<p>As you may notice I use one-value-arrays to store the timers and countdowns. This is simple because they have <a href=\"https://docs.yoyogames.com/source/dadiospice/002_reference/001_gml%20language%20overview/accessors.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><strong>accessors</strong></a> (the @ I use when setting the array), which means you do not have to use the akward <code>my_timer = timer_update(my_timer);</code>. I did leave in returning the array though, in case that is the style you prefer.</p>\n<p>A timer system could easily be made, where you do not need the update scripts. In fact, the first iterations of the scripts did not need them, since it was using <a href=\"https://docs.yoyogames.com/source/dadiospice/002_reference/date%20and%20time/current_time.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><strong>current_time</strong></a> for the timing. However, I opted to use <a href=\"https://docs.yoyogames.com/source/dadiospice/002_reference/date%20and%20time/delta_time.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><strong>delta_time</strong></a> instead, because this allows you to still use pause systems and generally gives more control - <strong>current_time</strong> would still keep counting no matter the state of the game! The <strong>delta_time</strong> still works across all room speeds and lag.</p>\n<p>Hope you will find these scripts helpful!</p>\n<p>Until next time,<br>\nSimon</p>\n"}},"context":{}}